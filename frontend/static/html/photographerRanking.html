<!DOCTYPE html>
<html>
<head>
    <title>Fallstudie</title>
    <link rel="icon" href="./images/Herzbeben_Logo.png">
    <link rel="stylesheet" href="compare_profile.css" type="text/css">
    <link rel="stylesheet" href="shootout.css" type="text/css">
    <!-- Latest compiled and minified CSS-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <script type=text/javascript src = "navbarFunction.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset= utf-8" />

</head>
<body>
<header class="navbar navbar-inverse navbar-fixed-top navbar-custom">
    <nav role="navigation">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#"> <img class="brandImage" src="./images/icon.png" alt="Home" width="30px" height="30px"> </a>
            </div>

            <!--creates Help button-->
            <div id="helpBtn3">
                <button class="helpBtn3">Help
                    <span class="helpText"> On this page you see the picture ranking of the selected shootout. To
                      get back to the different shootouts click on "Shootout Rankings" at the top menu.
      </span>
                </button>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav"></ul>
                <form class="navbar-form navbar-left">
                    <button type="button" class="btn btn-default" id="UserSearchbtn" onclick="locationChange()">Search for Users</button>
                    <!-- <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search">
                    </div>
                    <button type="submit" class="btn btn-default">Submit</button> -->
                </form>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="impressum.html">Impressum</a></li>
                    <li><a href="compare.html">Compare Pictures</a></li>
                    <li><a href="leaderboards.html">Leaderboards</a></li>
                    <!--a onclick="dropdownMenu()" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Leaderboards <span class="caret"></span></a>
                     <ul id="dropdown" class="dropdown-menu" aria-labelledby="dropdownMenu1">
                        <li><a href="pictureRanking.html">Picture Ranking</a></li>
                        <li><a href="photographerRanking.html">Photographer Ranking</a></li>
                        <li><a href="shootoutÜbersicht.html">Shootout Rankings</a></li>
                        <li role="separator" class="divider"></li>
                    </ul>
                </li-->
                    <li><a href="profile.html">Profile</a></li>
                    <li class="dropdown">
                        <a onclick="dropdownMenu()" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Menu <span class="caret"></span></a>
                        <ul id="dropdown" class="dropdown-menu" aria-labelledby="dropdownMenu1">
                            <li><a href="allusers.html">All Users</a></li>
                            <li><a href="allphotos.html">All Pictures</a></li>
                            <li><a href="FAQ.html">FAQ</a></li>
                            <li><a href="AGB.html">AGB's</a></li>
                        </ul>
                    </li>
                </ul>
            </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
    </nav>
</header>

<div id="ranking">
    <br>
    <h1>Top ranked photographers</h1>
    <h2>The 3 best photographers</h2>
    <br><br>
</div>

<div class="container">
   <div class="column" style="text-align: center">
    <div id="Best-photographer">
        <h4>No.1 Photographer:</h4>
        <h4 style="color: #9F454B" id="1username"></h4> <br>
        <p>Wins:</p>
        <h4 id="bestphotowins"></h4> <br><br><br>
        <h5 style="text-align: right"> <i>Best picture:</i></h5>
    </div> <br><hr>
    <div id="Second-photo">
        <h4>No.2 Photographer:</h4>
        <h4 style="color: #9F454B" id="2username"></h4> <br>
        <p>Wins:</p>
        <h4 id="secondphotowins"></h4> <br><br><br>
        <h5 style="text-align: right"><i>Best picture:</i></h5>
    </div> <br><hr>
    <div id="Third-photo">
        <h4>No.3 Photographer:</h4>
        <h4 style="color: #9F454B" id="3username"></h4> <br>
        <p>Wins:</p>
        <h4 id="thirdphotowins"></h4> <br><br>
        <h5 style="text-align: right"> <i>Best picture:</i></h5>
    </div>
   </div>

   <div class="column">
       <div>
           <img id="bestphoto" src="" alt="no pictures ranked yet" style="width:100%" height="250px" width="280px">
       </div> <br><br>
       <div>
           <img id="secondphoto" src="" alt="no pictures ranked yet" style="width:100%" height="250px" width="280px">
       </div><br><br>
       <div>
           <img id="thirdphoto" src="" alt="no pictures ranked yet" style="width:100%" height="250px" width="280px">
       </div>


   </div>
</div>
<style>
    * {
        box-sizing: border-box;
    }

    .container {
        display: flex;
    }

    /* Create two equal columns that sits next to each other */
    .column {
        flex: 50%;
        padding: 10px;
        height: 300px; /* Should be removed. Only for demonstration */
    }
</style>

<script>
    window.onload = function () {
        alert('in function');
        var xmlhttplog2 = new XMLHttpRequest(); // new HttpRequest instance

        xmlhttplog2.open("GET", "http://localhost:8080/meetme/api/photo/bestbywins", true);
        xmlhttplog2.setRequestHeader("Content-Type", "application/json");
        //sent the new HttpRequest
        //var data = JSON.stringify(json);
        xmlhttplog2.send(null);
        console.log('request für top fotografen gesendet');

        xmlhttplog2.onreadystatechange = function () {
            if (xmlhttplog2.readyState == XMLHttpRequest.DONE) {
                var json = xmlhttplog2.responseText;
                var userlist = JSON.parse(json);
                userlist.reverse();

                //User1 ------------------------------------------------------------------------
                document.getElementById('bestphoto').src = userlist[0].picture;
                document.getElementById('bestphotowins').innerText = userlist[0].wins;
                //document.getElementById('1username').innerText = userlist[0].person.username;
                var username1;
                username1 = userlist[0].person.username;
                alert(username1);
                document.getElementById('1username').innerText = username1;
                if (username1 == undefined) {
                    var pid1 = userlist[0].person;
                    var xmlusername = new XMLHttpRequest(); // new HttpRequest instance
                    xmlusername.open("GET", "http://localhost:8080/meetme/api/person/" + pid1, true);
                    xmlusername.setRequestHeader("Content-Type", "application/json");
                    xmlusername.send(null);
                    xmlusername.onreadystatechange = function () {
                        if (xmlusername.readyState == XMLHttpRequest.DONE) {
                            var json = xmlusername.responseText;
                            var user = JSON.parse(json);
                            //alert(user.username);
                            username1 = user.username;
                            document.getElementById('1username').innerText = username1;
                        }
                    };
                }
                //User 2-------------------------------------------------------------------------
                document.getElementById('secondphoto').src = userlist[1].picture;
                document.getElementById('secondphotowins').innerText = userlist[1].wins;
                var username2;
                username2 = userlist[1].person.username;
                document.getElementById('2username').innerText = username2;

                // alert(username2);
                if (username2 == undefined) {
                    var pid2 = userlist[1].person;
                    var xmlusername2 = new XMLHttpRequest(); // new HttpRequest instance
                    xmlusername2.open("GET", "http://localhost:8080/meetme/api/person/" + pid2, true);
                    xmlusername2.setRequestHeader("Content-Type", "application/json");
                    xmlusername2.send(null);
                    xmlusername2.onreadystatechange = function () {
                        if (xmlusername2.readyState == XMLHttpRequest.DONE) {
                            var json = xmlusername2.responseText;
                            var user = JSON.parse(json);
                            //alert(user.username);
                            username2 = user.username;
                            document.getElementById('2username').innerText = username2;
                        }
                    };
                }

//User 3-------------------------------------------------------------------------
                document.getElementById('thirdphoto').src = userlist[2].picture;
                document.getElementById('thirdphotowins').innerText = userlist[2].wins;
                var username3 = userlist[2].person.username;
                document.getElementById('3username').innerText = username3;
                //alert(username3);
                if (username3 == undefined) {
                    var pid3 = userlist[2].person;
                    var xmlusername3 = new XMLHttpRequest(); // new HttpRequest instance
                    xmlusername3.open("GET", "http://localhost:8080/meetme/api/person/" + pid3, true);
                    xmlusername3.setRequestHeader("Content-Type", "application/json");
                    xmlusername3.send(null);
                    xmlusername3.onreadystatechange = function () {
                        if (xmlusername3.readyState == XMLHttpRequest.DONE) {
                            var json = xmlusername3.responseText;
                            var user = JSON.parse(json);
                            //alert(user.username);
                            username3 = user.username;
                            document.getElementById('3username').innerText = username3;
                        }
                    };
                    //  alert(username3);
                }

            }
        };
    };
</script>

<footer class="footer">
    <p>Klicks Inc. © 2018</p>
</footer>

</body>
</html>